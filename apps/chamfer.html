
<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>chamfer &mdash; pdal.io</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/pdal.css" type="text/css" />
      <link rel="stylesheet" href="../_static/breathe.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://pdal.io/apps/chamfer.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="delta" href="delta.html" />
    <link rel="prev" title="Applications" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PDAL
          </a>
              <div class="version">
                2.7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Applications</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">chamfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="delta.html">delta</a></li>
<li class="toctree-l2"><a class="reference internal" href="density.html">density</a></li>
<li class="toctree-l2"><a class="reference internal" href="eval.html">eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="ground.html">ground</a></li>
<li class="toctree-l2"><a class="reference internal" href="hausdorff.html">hausdorff</a></li>
<li class="toctree-l2"><a class="reference internal" href="info.html">info</a></li>
<li class="toctree-l2"><a class="reference internal" href="merge.html">merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html">pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">random</a></li>
<li class="toctree-l2"><a class="reference internal" href="sort.html">sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="split.html">split</a></li>
<li class="toctree-l2"><a class="reference internal" href="tile.html">tile</a></li>
<li class="toctree-l2"><a class="reference internal" href="tindex.html">tindex</a></li>
<li class="toctree-l2"><a class="reference internal" href="translate.html">translate</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pipeline.html">Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stages/stages.html">Stages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stages/readers.html">Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stages/writers.html">Writers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stages/filters.html">Filters</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dimensions.html">Dimensions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../types.html">Types</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python.html">Python</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../java.html">Java</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../workshop/index.html">Workshop</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../project/index.html">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">License</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PDAL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html"> Documentation </a> &raquo;</li>
      
          <li><a href="index.html">Applications</a> &raquo;</li>
      
      <li>chamfer</li>
    

    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/PDAL/PDAL/edit/master/doc/apps/chamfer.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="delta.html" class="btn btn-neutral float-right" title="delta" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Applications" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="chamfer">
<span id="chamfer-command"></span><h1>chamfer<a class="headerlink" href="#chamfer" title="Permalink to this heading"></a></h1>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>As of PDAL v2.6.0, the <code class="docutils literal notranslate"><span class="pre">chamfer</span></code> command is marked as DEPRECATED. It will be
removed from the default install in PDAL v2.7 and removed completely in PDAL
v2.8.</p>
<p>The following Python code can be used with the PDAL Python bindings to compute
the chamfer distance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pdal</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">chamfer_distance</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">):</span>
    <span class="n">distance_1_to_2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">distance_2_to_1</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">points1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">arr1</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">arr1</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">arr2</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]))</span>
    <span class="n">points2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">arr2</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span> <span class="n">arr2</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">arr2</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]))</span>

    <span class="c1"># Compute distance from each point in arr1 to arr2</span>
    <span class="k">for</span> <span class="n">p1</span> <span class="ow">in</span> <span class="n">points1</span><span class="p">:</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">points2</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">min_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
        <span class="n">distance_1_to_2</span> <span class="o">+=</span> <span class="n">min_distance</span>

    <span class="c1"># Compute distance from each point in arr2 to arr1</span>
    <span class="k">for</span> <span class="n">p2</span> <span class="ow">in</span> <span class="n">points2</span><span class="p">:</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">points1</span> <span class="o">-</span> <span class="n">p2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">min_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
        <span class="n">distance_2_to_1</span> <span class="o">+=</span> <span class="n">min_distance</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">distance_1_to_2</span> <span class="o">+</span> <span class="n">distance_2_to_1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr2</span><span class="p">))</span>

<span class="n">pipeline1</span> <span class="o">=</span> <span class="n">pdal</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="s2">&quot;/path/to/input1.laz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
<span class="n">pipeline1</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="n">arr1</span> <span class="o">=</span> <span class="n">pipeline1</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">pipeline2</span> <span class="o">=</span> <span class="n">pdal</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="s2">&quot;/path/to/input2.laz&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
<span class="n">pipeline2</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="n">arr2</span> <span class="o">=</span> <span class="n">pipeline2</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Compute Chamfer distance</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">chamfer_distance</span><span class="p">(</span><span class="n">arr1</span><span class="p">,</span> <span class="n">arr2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Chamfer Distance:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>Popular Python packages such as scipy and sklearn have functions to compute
the pairwise distance between points and can be used to simplify the above
somewhat.</p>
<p>Note that the provided code does not match exactly the output of PDAL's
original implementation, which summed the square of the distance to the
nearest neighbor. We have elected not to update the PDAL implementation at
this time.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">chamfer</span></code> command is used to compute the Chamfer distance between two
point clouds. The Chamfer distance is computed by summing the squared distances
between nearest neighbor correspondences of two point clouds.</p>
<p>More formally, for two non-empty subsets <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, the Chamfer
distance <span class="math notranslate nohighlight">\(d_{CD}(X,Y)\)</span> is</p>
<div class="math notranslate nohighlight">
\[d_{CD}(X,Y) = \sum_{x \in X} \operatorname*{min}_{y \in Y} ||x-y||^2_2 + \sum_{y \in Y} \operatorname*{min}_{x \in X} ||x-y||^2_2\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pdal chamfer &lt;source&gt; &lt;candidate&gt;
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">source</span> <span class="n">arg</span>     <span class="n">Source</span> <span class="n">filename</span>
<span class="o">--</span><span class="n">candidate</span> <span class="n">arg</span>  <span class="n">Candidate</span> <span class="n">filename</span>
</pre></div>
</div>
<p>The algorithm makes no distinction between source and candidate files (i.e.,
they can be transposed with no affect on the computed distance).</p>
<p>The command returns 0 along with a JSON-formatted message summarizing the PDAL
version, source and candidate filenames, and the Chamfer distance. Identical
point clouds will return a Chamfer distance of 0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pdal chamfer source.las candidate.las
{
  &quot;filenames&quot;:
  [
    &quot;\/path\/to\/source.las&quot;,
    &quot;\/path\/to\/candidate.las&quot;
  ],
  &quot;chamfer&quot;: 1.303648726,
  &quot;pdal_version&quot;: &quot;1.3.0 (git-version: 191301)&quot;
}
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>The Chamfer distance is computed for XYZ coordinates only and as such says
nothing about differences in other dimensions or metadata.</p>
</div>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="delta.html" class="btn btn-neutral float-right" title="delta" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <div class="info">
      <a class="logo-link" href="https://hobu.co">
        <div class="hobu-logo"></div>
      </a>
      <div class="copyright">
      

                    &copy;  2024
                        <a href="https://github.com/abellgithub">Andrew Bell</a>,
                        <a href="https://github.com/chambbj">Brad Chambers</a>,
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>.

      
      最終更新: 8月 04, 2024
      </div>
    </div>
</footer>
        </div>
      </div>
    </section>
  </div>
  
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <div class="footer">
        <div class="container">
                    &copy;  2024
                        <a href="http://github.com/hobu">Howard Butler</a>,
                        <a href="http://github.com/mpgerlek">Michael Gerlek</a>,
                        and
                        <a href="https://github.com/PDAL/PDAL/graphs/contributors">others</a>,
                Last updated
                    on 8月 04, 2024.
        </div>
    </div>

</body>
</html>